<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GAミーティング会場の検索</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    body {
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    h1 {
      text-align: center;
      margin-top: 20px;
      color: #333;
    }

    #map {
      width: 100%;
      height: 500px;
    }

    .location-list {
      list-style-type: none;
      padding: 0;
      margin: 20px 0;
    }

    .location-list li {
      padding: 10px;
      margin-bottom: 10px;
      background-color: #f8f9fa;
      border-radius: 5px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .location-list li a {
      text-decoration: none;
      color: #007bff;
      font-weight: bold;
    }

    .location-list li .google-link {
      font-size: 0.9em;
      color: #28a745;
    }

    @media (max-width: 768px) {
      h1 {
        font-size: 1.5em;
      }

      #map {
        height: 400px;
      }

      .location-list li {
        font-size: 0.9em;
      }
    }
  </style>
</head>
<body>

  <h1>最寄りのGAミーティング会場を探す</h1>

  <div id="map"></div>

  <ul class="location-list" id="location-list"></ul>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // サンプルデータ（会場の位置と名前）
    var meetingLocations = [
      { name: "東京駅", latitude: 35.681236, longitude: 139.767125 },
      { name: "東京タワー", latitude: 35.658581, longitude: 139.745433 },
      { name: "スカイツリー", latitude: 35.710063, longitude: 139.8107 },
      { name: "新宿駅", latitude: 35.6895, longitude: 139.6917 },
      { name: "渋谷駅", latitude: 35.658034, longitude: 139.701636 },
      { name: "札幌駅", latitude: 43.0687, longitude: 141.3508 },
      { name: "すすきの", latitude: 43.5891, longitude: 141.3707 },
      { name: "青森駅", latitude: 40.8221, longitude: 140.7475 },
      { name: "仙台駅", latitude: 38.2682, longitude: 140.8694 },
      { name: "名古屋駅", latitude: 35.170915, longitude: 136.8812 },
      { name: "大阪駅", latitude: 34.702485, longitude: 135.495951 },
      { name: "京都駅", latitude: 35.0116, longitude: 135.7681 },
      { name: "広島駅", latitude: 34.3963, longitude: 132.4594 },
      { name: "福岡駅", latitude: 33.5902, longitude: 130.4017 },
      { name: "那覇", latitude: 26.2124, longitude: 127.6809 },
      { name: "沖縄市", latitude: 26.338, longitude: 127.803 },
      { name: "釧路駅", latitude: 42.9764, longitude: 144.3793 },
      { name: "鹿児島中央駅", latitude: 31.5895, longitude: 130.5576 },
      { name: "長崎駅", latitude: 32.7503, longitude: 129.8777 },
      { name: "高松駅", latitude: 34.3428, longitude: 134.0467 }
    ];

    // 地図の初期化
    var map = L.map('map').setView([35.681236, 139.767125], 5);  // 初期位置を東京駅周辺に設定

    // OpenStreetMapのタイルレイヤーを追加
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    // 現在地表示の設定
    map.locate({ setView: true, maxZoom: 16 });  // 現在地を自動で取得して表示

    // 現在地が取得できたときのイベント
    map.on('locationfound', function(e) {
      L.marker(e.latlng).addTo(map)
        .bindPopup('あなたの現在地')
        .openPopup();
    });

    // 現在地が取得できなかったときのイベント
    map.on('locationerror', function(e) {
      alert("現在地の取得に失敗しました");
    });

    // 各会場にピンを追加し、リストも作成
    var locationList = document.getElementById('location-list');
    meetingLocations.forEach(function(location) {
      // ピンを立てる
      var marker = L.marker([location.latitude, location.longitude]).addTo(map);
      
      // リストの項目を作成
      var listItem = document.createElement('li');
      var link = document.createElement('a');
      link.href = '#';
      link.textContent = location.name;
      listItem.appendChild(link);

      // Googleマップで開くリンクを作成
      var googleLink = document.createElement('a');
      googleLink.href = `https://www.google.com/maps?q=${location.latitude},${location.longitude}`;
      googleLink.target = '_blank';
      googleLink.classList.add('google-link');
      googleLink.textContent = 'Googleマップで開く';

      // Googleマップでルートを検索するリンクを作成
      var routeLink = document.createElement('a');
      routeLink.href = `https://www.google.com/maps/dir/?api=1&origin=${map.getCenter().lat},${map.getCenter().lng}&destination=${location.latitude},${location.longitude}`;
      routeLink.target = '_blank';
      routeLink.classList.add('google-link');
      routeLink.textContent = 'ルート検索';

      listItem.appendChild(googleLink);
      listItem.appendChild(routeLink);
      locationList.appendChild(listItem);

      // リスト項目をクリックすると、該当するピンにズームイン
      link.addEventListener('click', function() {
        map.setView([location.latitude, location.longitude], 13);
        marker.openPopup();
      });
    });
  </script>
</body>
</html>
